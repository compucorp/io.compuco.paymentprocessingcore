services:
  phpstan:
    image: php:8.1-cli
    volumes:
      - .:/app
    working_dir: /app
    entrypoint: []
    command: >
      sh -c "
      if [ ! -f /tmp/phpstan.phar ]; then
        curl -sL https://github.com/phpstan/phpstan/releases/download/1.12.10/phpstan.phar -o /tmp/phpstan.phar &&
        chmod +x /tmp/phpstan.phar
      fi &&
      php /tmp/phpstan.phar analyse -c phpstan.neon --memory-limit=1G
      "
